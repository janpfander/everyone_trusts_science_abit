# Experiment 3 {#exp3}

## Materials

\FloatBarrier

See Appendix \@ref(exp1). 

## Comparing items

### Conspiracy theories

Table \@ref(tab:exp3-correlation-conspiracy) shows the correlations of the three different scales assessing conspiracy thinking.

```{r exp3-correlation-conspiracy}
correlation_matrix <- exp3_wide %>%
  select(BCTI_avg, CMQ_avg, SICBS) %>% 
  rename(BCTI = BCTI_avg, 
         CMQ = CMQ_avg) %>% 
  cor()

apa_table(correlation_matrix, 
          caption = "Correlations of the three different scales assessing conspiracy thinking",
          placement = "h")
```

### Trust in science

Table \@ref(tab:exp3-correlation-trust) shows the correlations of the three different items measuring trust in science.

```{r exp3-correlation-trust}
correlation_matrix <- exp3_wide %>%
  select(wgm_sciencegeneral, wgm_scientists, pew) %>% 
  cor()

apa_table(correlation_matrix, 
          caption = "Correlations of the three different items measuring trust in science",
          placement = "h")
```

## Correlations with alternative measures

Table \@ref(tab:exp3-correlations-outcomes) shows the correlations between knowledge and acceptance, respectively, and outcome variables.

```{r}
# Standardize all variables. Linear regression on standardized variables is equivalent to correlation
standardized_variables <- exp3_wide %>% 
  select(avg_acceptance, avg_knowledge, BCTI_avg, CMQ_avg, SICBS, wgm_scientists, wgm_sciencegeneral, pew) %>% 
  mutate(across(everything(), ~scale(.x)))
```

```{r}
# List of variables
variables <- c("BCTI_avg", "CMQ_avg", "SICBS", "wgm_scientists", "wgm_sciencegeneral", "pew")

# Run regression for each variable and store results in a list
results_list_knowledge <- map(variables, ~ run_regression(standardized_variables, .x, "avg_knowledge"))
results_list_acceptance <- map(variables, ~ run_regression(standardized_variables, .x, "avg_acceptance"))
```

```{r exp3-correlations-outcomes}
# as data frame/output table
results <- bind_rows(list(results_list_knowledge, results_list_acceptance))
results %>% 
  filter(term != "intercept") %>%
  pivot_wider(names_from = term, 
              values_from = estimate) %>% 
  rename(`Correlation with knowledge` = avg_knowledge, 
         `Correlation with acceptance` = avg_acceptance, 
  ) %>% 
  mutate_if(is.numeric, round, digits = 2) %>% 
  mutate(outcome = case_when(outcome == "BCTI_avg" ~ "BCTI \n(main conspiracy measure)", 
                             outcome == "CMQ_avg" ~ "CMQ", 
                             outcome == "SICBS" ~ "SICBS", 
                             outcome == "wgm_scientists" ~ "WGM trust scientists",
                             outcome == "wgm_sciencegeneral" ~ "WGM trust general \n(main trust measure)",
                             outcome == "pew" ~ "PEW trust scientists",
                             )) %>% 
  apa_table(caption = "Correlations between knowledge and acceptance, respectively, and outcome variables")
```

## Results conditional on false responses

Table \@ref(tab:exp3-false-response-regression) shows the correlations between acceptance and outcome variables based on linear regression models on standardized values.

```{r}
# Standardize all variables. Linear regression on standardized variables is equivalent to correlation
standardized_variables <- exp3_false_knowledge %>% 
  select(avg_acceptance, BCTI_avg, CMQ_avg, SICBS, wgm_scientists, wgm_sciencegeneral, pew) %>% 
  mutate(across(everything(), ~scale(.x)))
```

```{r}
# Run regression for each variable and store results in a list
results_list <- setNames(map(variables, ~ run_regression(standardized_variables, .x, "avg_acceptance", return = "model")), variables)
```

```{r exp3-false-response-regression}
modelsummary(results_list, 
             stars = TRUE,
             caption = "Based on false response data only, correlations between acceptance and outcome variables based on linear regression models on standardized values") 
```

## By-question variation

```{r}
# calculate share
plot_data <- exp3_long %>% 
  group_by(subject) %>% 
  summarize(share_true = sum(knowledge == TRUE, na.rm = TRUE)/n(),
            share_accepted = sum(acceptance == "Yes", na.rm = TRUE)/n()) 
```

### Knowledge

(ref:exp3-questions-knowledge) Distribution of correct answers by question. 

```{r exp3-questions-knowledge, fig.cap="(ref:exp3-questions-knowledge)"}
# plot knowledge
ggplot(plot_data, aes(x = reorder(subject, share_true), y = share_true)) +
  geom_col() +
  scale_y_continuous(labels = scales::percent_format(), breaks = seq(0, 1, 0.1)) +
  labs(x = "Question", y = "Share of correct responses") +
  coord_flip()
```

(ref:exp3-questions-acceptance) Distribution of consensus acceptance by question. 

```{r exp3-questions-acceptance, fig.cap="(ref:exp3-questions-acceptance)"}
# plot acceptance
ggplot(plot_data, aes(x = reorder(subject, share_accepted), y = share_accepted)) +
  geom_col() +
  scale_y_continuous(labels = scales::percent_format(), breaks = seq(0, 1, 0.1)) +
  labs(x = "Question", y = "Share of acceptance") +
  coord_flip()
```

## Trust in science

(ref:exp3-trust-scientists) Distribution of trust in scientists. 

```{r exp3-trust-scientists, fig.cap="(ref:exp3-trust-scientists)"}
# calculate share
plot_data <- exp3_wide %>% 
  group_by(wgm_scientists) %>% 
  summarize(n = n()) %>% 
  ungroup() %>% 
  mutate(share = n/sum(n)) %>% 
  rounded_numbers()

# plot knowledge
ggplot(plot_data, aes(x = wgm_scientists, y = share)) +
  geom_col() +
  scale_y_continuous(labels = scales::percent_format(), breaks = seq(0, 1, 0.1)) +
  labs(x = "Trust in science", y = "Share of participants") +
  geom_text(aes(label = paste0(round(share * 100, 1), "%")),
            position = position_dodge(width = 0.9),
            vjust = -0.5, size = 3) 
```

## Conspiracy thinking

(ref:exp3-conspiracy-distribution) Distribution of conspiracy thinking. 

```{r exp3-conspiracy-distribution, fig.cap="(ref:exp3-conspiracy-distribution)"}
# plot knowledge
ggplot(exp3_wide, aes(x = BCTI_avg)) +
  geom_histogram() +
  labs(x = "Average conspiracy thinking (BCTI)", y = "N")
```

### By-item variation

(ref:exp3-conspiracy-items) Distribution of conspiracy thinking by item. 

```{r exp3-conspiracy-items, fig.cap="(ref:exp3-conspiracy-items)"}
BCTI_data <- exp3_long %>% 
  # bring to long format
  pivot_longer(cols = BCTI_apollo:BCTI_evolution, 
               names_to = "BCTI_item", values_to = "score") %>% 
  select(id, c(starts_with("BCTI"), score)) %>% 
  group_by(BCTI_item) %>% 
  summarize(avg_score = mean(score, na.rm=TRUE)) %>% 
  ungroup()

ggplot(BCTI_data, aes(x = reorder(BCTI_item, avg_score), y = avg_score)) +
    geom_pointrange(aes(ymin = 1, ymax = avg_score),
                  # Make the lines a little thicker and the dots a little bigger
                  fatten = 2, size = 1) +
  scale_y_continuous(limits = c(1, 9), breaks = seq(1, 9, 1)) +
  labs(x = "Conspiracy item", y = "Average score") +
  coord_cartesian(ylim = c(1, 9)) +
  coord_flip()
```

## Reasons for consensus rejection

### All raw answers

```{r exp3-reasons-rejection}
# store all variables
reasons_rejection <- c("electrons", "antibiotics", "continents", "sex", "lasers", 
               "orbit", "diamonds", "speed", "salt", "water")


table <- exp3_wide %>% 
  select(id, all_of(reasons_rejection)) %>% 
  pivot_longer(all_of(reasons_rejection), 
               names_to = "question",
               values_to = "answer") %>% 
  drop_na(answer) %>% 
  arrange(id)

# apa_table(table,
#           align = c("m{1cm}", "m{3cm}", "m{10cm}"), 
#           longtable = TRUE
#           )
kbl(table, booktabs = T, longtable = TRUE,
    caption = "Reasons for consensus rejection") %>%
  kable_paper(full_width = F) %>% 
  column_spec(1) %>%
  column_spec(2) %>%
  column_spec(3, width = "30em") 

```

## Why do people accept the scientific consensus:

### Participants who answered "other"

```{r exp3-other-reasons-acceptance}
# store all variables
table <- exp3_wide %>% 
  select(id, other_reason_agreement) %>% 
  drop_na(other_reason_agreement) %>% 
  arrange(id)

kbl(table, booktabs = T, longtable = TRUE,
    caption = "Reasons for consensus rejection") %>%
  kable_paper(full_width = F) %>% 
  column_spec(1) %>%
  column_spec(2, width = "30em")
```

## How did participants independently verifiy?

### Participants who answered "other"

```{r exp3-independent-verification}
# store all variables
table <- exp3_wide %>% 
  select(id, reason_followup) %>% 
  drop_na(reason_followup) %>% 
  arrange(id)

kbl(table, booktabs = T, longtable = TRUE,
    caption = "Reasons for consensus rejection") %>%
  kable_paper(full_width = F) %>% 
  column_spec(1) %>%
  column_spec(2, width = "30em")
```




